tags: [[AppSrv]]
# Documentation  

## Overview

Docker is an open platform for developing, shipping, and running applications in containers. Containers allow you to package applications with their dependencies, ensuring consistency across development, testing, and production environments. This documentation provides a comprehensive guide to installing Docker, understanding its architecture, and working with a sample Todo App project.

---
## Prerequisites
  
To use Docker on a Windows system, you need to install the Windows Subsystem for Linux (WSL) and a Linux distribution, such as Ubuntu.
### Installing WSL and Ubuntu

  1. **Install WSL**:

   - Open PowerShell as Administrator and run:

     ```bash

     wsl --install

     ```

   - This command installs WSL and the default Ubuntu distribution.

  2. **Set Up Ubuntu**:

   - After installation, launch Ubuntu from the Start menu.

   - Follow the prompts to create a user account and password for the Linux environment.

  

> **Note**: In the context of WSL, a distribution is a packaged root filesystem that provides a specific Linux environment, allowing users to run Linux command-line tools and applications directly on Windows.

  ---
## Installing Docker Desktop

  Docker Desktop is a user-friendly application for managing Docker containers on Windows, macOS, and Linux.

1. **Download and Install**:

   - Visit the [Docker Desktop documentation](https://docs.docker.com/desktop/) for detailed installation instructions.

   - Download the installer from the official Docker website and follow the setup wizard.

1. **Verify Installation**:

   - Open a terminal and run:

     ```bash

     docker --version

     ```

   - Ensure Docker Desktop is running in the system tray.

  ---
## Understanding Docker

Docker enables you to separate applications from infrastructure, allowing rapid software delivery. It provides tools to manage the lifecycle of containers, from development to production.

  ### Key Benefits

  - **Isolation**: Containers run applications in isolated environments, ensuring consistency across systems.

- **Portability**: Containers include all dependencies, making them portable across different environments.

- **Efficiency**: Containers are lightweight compared to virtual machines, optimizing resource usage.

### Docker Architecture
  
Docker uses a client-server architecture:

  - **Docker Daemon** (`dockerd`): Manages Docker objects (images, containers, networks, volumes) and listens for API requests.

- **Docker Client** (`docker`): The primary interface for users to interact with the daemon via commands like `docker run`.

- **Docker Registries**: Stores Docker images. Docker Hub is the default public registry, but private registries can also be used.

- **Docker Compose**: A tool for defining and running multi-container applications.
 
 ![Docker Architecture](docker-architecture.webp)

### Docker Objects

- **Images**: Read-only templates for creating containers. Images are built from a `Dockerfile` and can be based on other images (e.g., an Ubuntu image with Apache installed).

- **Containers**: Runnable instances of images, isolated from the host system.

- **Networks**: Enable communication between containers.

- **Volumes**: Persist data generated by containers.

### Containers



---
## Getting Started with Docker

### Running a Simple Container

To test Docker, run the following command to start a container from the `docker/welcome-to-docker` image:

```bash

docker run -d -p 8080:80 docker/welcome-to-docker

```

  - **Explanation**:

  - `-d`: Runs the container in detached mode (in the background).

  - `-p 8080:80`: Maps port 8080 on the host to port 80 in the container.

- Access the container at [http://localhost:8080](http://localhost:8080/).

---
## Docker Project: Todo App

  This section guides you through setting up a sample Todo App using Docker. The project demonstrates a multi-container application with a React frontend, Node backend, MySQL database, phpMyAdmin, and Traefik proxy.

  **Reference**: [Docker Todo App Tutorial](https://docs.docker.com/get-started/introduction/develop-with-containers/)

### Project Components

The Todo App environment includes:

- **React Frontend**: A Node container running a React development server using [Vite](https://vitejs.dev/).

- **Node Backend**: Provides an API for managing to-do items (retrieve, create, delete).

- **MySQL Database**: Stores the list of to-do items.

- **phpMyAdmin**: A web interface for database management, accessible at [http://db.localhost](http://db.localhost/).

- **Traefik Proxy**: Routes requests to the appropriate service:

  - `localhost/api/*` → Backend

  - `localhost/*` → Frontend

  - `db.localhost` → phpMyAdmin'
### Setting Up the Todo App

  1. **Clone the Project**:

   - Clone the Todo App repository or follow the instructions in the [Docker documentation](https://docs.docker.com/get-started/introduction/develop-with-containers/).

1. **Build and Run**:

   - Navigate to the project directory and run:

     ```bash

     docker compose up -d

     ```

   - If the build fails due to cached layers, force a fresh build:

     ```bash

     docker compose build --no-cache

     ```

3. **Access the Application**:

   - Frontend: [http://localhost](http://localhost/)

   - phpMyAdmin: [http://db.localhost](http://db.localhost/)

3. **Stop the Application**:

   - To stop and remove containers:

     ```bash

     docker compose down

     ```

   - To also delete volumes (warning: this deletes all data):

     ```bash

     docker compose down -v

     ```

### Developing with VS Code

- Open the project in Visual Studio Code to explore the codebase.

- The `docker-compose.yml` file defines the services, networks, and volumes for the application.

  ---

  ## Docker Commands

Below is a list of commonly used Docker commands for managing the Todo App and other projects.

  ### Installation Commands


```bash

# Install Docker and Docker Compose on Ubuntu

sudo apt update && sudo apt install -y docker.io docker-compose

  

# Enable and start Docker service

sudo systemctl enable docker

sudo systemctl start docker

```


  ### Application Management

  ```bash

# Start the application in detached mode

docker compose up -d

  

# Stop and remove containers

docker compose down

  

# Stop and remove containers and volumes (deletes data)

docker compose down -v

  

# View logs for a specific container

docker compose logs -f <container_name>

```

  ### Database Management

```bash

# Generate a secure password for database

openssl rand -base64 32

  

# Backup MariaDB database

docker exec mariadb mysqldump -u bookstackuser -p'0MlpUigtZp+QNwIP7rXrMXDAvACUZ5dBqtcHeNJhJFU=' bookstackapp > C:\dev\bookstack\backup.sql

  

# Generate application key (e.g., for Laravel apps)

docker exec <container_name> php /app/www/artisan key:generate --show

```

### Troubleshooting

To reset the database (e.g., for a fresh start):

1. Stop and remove containers:

   ```bash

   docker-compose -f C:\dev\bookstack\docker-compose.yml down

   ```

  2. Delete MariaDB data:

   ```bash

   rm -rf C:\dev\bookstack\mariadb

   ```

  3. Restart the containers:

   ```bash

   docker-compose -f C:\dev\bookstack\docker-compose.yml up -d

   ```

> **Warning**: Resetting the database deletes all data. Use default credentials to log in after resetting.

  ---
## Building and Pushing Images

To create and share a custom Docker image:

  1. **Create a Dockerfile**:

   - Define the steps to build your application (e.g., based on an Ubuntu image with additional configurations).

   - Example: A Dockerfile for a web app might install Apache and copy application files.

1. **Build the Image**:

   ```bash

   docker build -t my-image:tag .

   ```

  2. **Push to a Registry**:

   - Log in to Docker Hub:

     ```bash

     docker login

     ```

   - Push the image:

     ```bash

     docker push my-image:tag

     ```


**Reference**: [Build and Push Your First Image](https://docs.docker.com/get-started/introduction/build-and-push-first-image/)

---
## Additional Resources

  

- [Docker Desktop Documentation](https://docs.docker.com/desktop/)

- [Docker Architecture Overview](https://docs.docker.com/get-started/docker-overview/#docker-architecture)

- [Docker Todo App Tutorial](https://docs.docker.com/get-started/introduction/develop-with-containers/)

- [Docker Hub](https://hub.docker.com/)